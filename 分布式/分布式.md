
# 分布式

+ Consistency and Consensus
    + Raft(etcd)
    + zab(zookeeper)
+ 分布式事务
    + 2pc,3pc
+ 分布式存储
    + HDFS
    + LSM

## CAP

+ Consistency
+ Availability
+ Partition tolerance

## BASE

+ CP
    + 暂停服务，等待同步完成
+ AP
    + 继续服务，最终一致

## raft(分布一致性协议)

+ 一致性(consensus)
    + 是具有容错性(fault-tolerant)的分布式系统的基础
    + 同一时刻所有节点对存储在其中的某个值都有相同结果
    + 小部分副本拓机，也可以对外服务
    + replicatred state machines
        + 所有节点从同一个state出发，经过同样的操作序列(log),最后达到同样的state

+ 选主
    + 超过半数投票

+ 复制日志
    + 维护数据一致性

## 分布式系统的8个谬误
+ The network is reliable
    + 存储转发

+ latency is zero
    + solution
        + CDN caching
        + event-driven

+ Bandwidth is infinite

+ The network is secure

+ Topology doesn't change

+ There is one administrator

+ Transport cost is zero

+ The network is homogeneous

## tips

+ 一致性哈希算法

+ 空节点查询问题
    + 过滤对不存在记录的查询

+ 秒杀系统、
    + 前端限流
    + 后端消息队列
        + 削峰
        + 异步处理

+ 分布式锁Zookeeper
    + 分布式系统访问共享资源

+ 分布式缓存
    + 一致性哈希算法
        + 决定访问哪个节点
    + 数据库与缓存一致
        + 先删缓存，再更新数据库；一般采用延时双删策略，即先删缓存，更新数据库，休眠1秒，再删缓存
            + 更新数据库的过程中，可能有其他线程在读数据，从而重新创建缓存
    + 缓存雪崩
    + 缓存穿透

+ Cassandra
    + 分布式数据库
    + No SQL

## ref

+ [分布式系统面试知识点](https://zhuanlan.zhihu.com/p/140272240)
+ [设计数据密集型应用](http://ddia.vonng.com/#/)
+ [分布式唯一ID生成器](https://zhuanlan.zhihu.com/p/65095562)


+ [What are the fallacies of distributed computing?](https://ably.com/blog/8-fallacies-of-distributed-computing)