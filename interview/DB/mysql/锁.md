## mysql锁

+ 表锁、页锁、行锁、间隙锁、临键锁、还有意向锁等，可以大致分为共享锁和排他锁
+ 锁粒度从大到小：表锁、页锁、行锁（记录锁、间隙锁、临键锁）
    + 行锁都是基于索引实现的，直接锁索引段，然后按照属性加共享或排他，除了主键索引会上锁，辅助索引也会。


## 行锁
+ Record lock

+ 当事务需要锁定某一行时，InnoDB 存储引擎会将对应索引记录上的锁定标记设置为需要的锁定类型（共享锁或排他锁）。这样，其他事务试图锁定同一索引记录时，InnoDB 会根据锁定类型判断是否允许进行锁定。这使得多个事务可以在同一表上同时操作不同行，从而提高并发性能。

+ 要是SQL的执行没有走索引就会扫表，行锁则无法实现，取而代之的是表锁。


## Gap Loc
+ 间隙锁，锁定一个范围，但不包含记录本身；

## Next-Key Lock
+ Gap Lock+Record Lock，锁定一个范围，并且锁定记录本身；

## 意向锁(Intent Lock)
+ 意向锁是一种层级锁，用来控制锁粒度，粒度可用加锁对象的大小进行衡量。 上级节点：指更大的加锁对象。例如选用 tuple 作为叶节点，table 作为上级节点。 意向锁加在上级节点上，如果意向锁不相容，就不需要再对下级节点加锁。

+ 意向锁（Intent Lock）是数据库中的一种锁定机制，用于在多粒度锁定系统中指示将要锁定某个资源（如表、页或行）的意图。它不是用来直接锁定数据的，而是用来通知其他事务或操作，该事务或操作将要对某个资源应用锁定操作。
    + 意向锁的存在有助于协调不同层次的锁定，以确保事务可以有效地共存并避免死锁。在多粒度锁定系统中，不同层次的锁定（如表级、页级和行级锁定）可能会相互影响，因此需要一种机制来指示对资源的锁定意图，以便其他事务可以根据需要适当地响应。

+ 意向共享锁（IS - Intent Shared Lock）： 意向共享锁表示事务打算对某个资源应用共享锁定。这意味着其他事务可以获取共享锁或意向共享锁，但不能获取排他锁。

+ 意向排他锁（IX - Intent Exclusive Lock）： 意向排他锁表示事务打算对某个资源应用排他锁定。这意味着其他事务可以获取意向共享锁，但不能获取共享锁或排他锁。