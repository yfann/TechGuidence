
## tun模式
+ TUN 是一个虚拟的 IP 层网卡，用来捕获和发送 IP 包，使 VPN/代理可以接管系统流量。

+ 在操作系统里创建一个虚拟的三层（IP 层）网络接口
    + 让应用程序可以像操作系统一样收发 IP 数据包

+ 一个由用户态应用程序控制的“虚拟网卡”
    + 内核把 IP 包交给 tun0
    + 用户态程序从 tun0 读取这个 IP 包
    + 程序决定怎么处理：加密、转发、构造隧道等
    + 程序把处理后的数据写回 tun0 或发送到网络
    + 内核收到用户程序写入的数据并按 IP 包转发

+ 场景
    + VPN（OpenVPN、WireGuard、V2Ray 等）
        + VPN 客户端通过 TUN 捕获所有 IP 流量，再加密后发给服务器
    + 透明代理（TUN 模式的 Clash、sing-box）
        + Clash 的 TUN 模式 = 把所有系统 IP 流量转发给 Clash 程序进行代理。
    + 容器网络/虚拟化网络（KVM, QEMU）
        + 虚拟机或容器可以用 TUN/TAP 与主机网络通信。

## tips
+ TUN = 三层设备（Layer 3），处理 IP 包
+ TAP = 二层设备（Layer 2），处理 以太网帧