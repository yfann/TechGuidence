## Redis主从复制
+ 一主多从，从节点会不断的从主节点同步数据。主节点提供读写功能，从节点提供读功能。一般来说会让主节点用于写操作，从节点用来读操作，读写分离减少服务器压力。
    + 但是从节点在同步数据的时候需要时间，可能就会造成数据不一致的情况，最好是读写都在主节点，从节点用来做热备了。

+ 哨兵模式（主从的扩展）
    + 哨兵其实是一个运行在特殊模式下的Redis进程。它有三个作用，分别是：监控、自动选主切换（简称选主）、通知。
        + 监控
            + 哨兵进程在运行期间，监视所有的Redis主节点和从节点。它通过周期性给主从库发送PING命令，检测主从库是否挂了。如果从库没有在规定时间内响应哨兵的PING命令，哨兵就会把它标记为下线状态；如果主库没有在规定时间内响应哨兵的PING命令，哨兵则会判定主库下线，然后开始切换到选主任务。
        + 选主
            + 其实就是从多个从库中，按照一定规则，选出一个当做主库
        + 通知
            + 选出主后，哨兵把新主的连接信息发给其他从库，让他们和新主建立主从关系。同时哨兵也会把新主通知给客户端，让他们把请求发到新主上。
    + 哨兵模式弊端
        + 每个节点存储的数据是一样的，浪费内存，并且不好在线扩容

+ 数据一致性
    + 读操作：主库、从库都可以执行处理；
    + 写操作：先在主库执行，再由主库将写操作同步给从库

+ 步骤
    + slave向master发送SYNC命令
    + master执行BGSAVE,后台生成RDB,使用缓冲区记录从现在开始执行的所有写命令
    + master把生成的RDB发给slave, slave用RDB更新
    + master将记录在缓冲区里的所有写命令发给slave,slave执行写命令

## Redis Cluster集群
+ 实现Redis的分布式存储，对数据分片，每台Redis节点上存不同内容，解决扩容问题。可以保存大量数据，分散数据到各个Redis实例，还提供复制和故障转移功能。
+ 客户端不需要连接集群所有节点，只要连接集群中任意一个可用节点即可。
+ Redis数据分片使用hash slot
    + 内置16384个哈希槽
    + 每个master负责16384的一个子集，master负责的哈希槽没有交集
    + 当多余master拥有的哈希槽集合总数为16384时，redis cluster才正常工作
+ 访问redis的key时，先进行CRC16计算出一个结果(0-32767),对16384取模
    + 如果数据在其他节点,则当前节点会返回负责这个hash slot的节点的IP和端口给客户端

## ref
+ [redis中主从、哨兵和集群这三个有什么区别 ](https://www.zhihu.com/question/293357668/answer/2954243723)